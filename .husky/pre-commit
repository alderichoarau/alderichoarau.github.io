#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running quality gate checks before commit..."
echo "â³ This may take a moment..."
echo ""

# Run lint-staged first (fast checks)
echo "ğŸ“ Running lint-staged (format + lint)..."
npx lint-staged

if [ $? -ne 0 ]; then
  echo "âŒ Lint-staged failed. Please fix the issues and try again."
  exit 1
fi

echo "âœ… Lint-staged passed!"
echo ""

# Build production (final check)
echo "ğŸ—ï¸ Building production to ensure deployability..."
npm run build:prod

if [ $? -ne 0 ]; then
  echo "âŒ Production build failed. Please fix the build issues and try again."
  exit 1
fi

echo "âœ… Production build successful!"
echo ""
echo "ğŸ‰ Quality gates passed! Proceeding with commit..."
echo ""
